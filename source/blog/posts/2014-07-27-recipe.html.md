---
title: かんたん献立シート
date: 2014-07-27 13:26 JST
tags: ウェブ
---


最近、Googleスプレッドシートの importXML関数にハマっています。いろいろと遊んでいる中で、さらに image関数では画像表示もできることを知りました。それならば、ぜひ画像を表示したい…とあれこれ考えてみて、そうだ、クックパッドのレシピ画像を表示できたらいいな、ということになりました。  
  
<p><br /></p>  
<p><a href="https://docs.google.com/spreadsheets/d/1YpToeif_6z-Nb3HXlo5VtG2eMUztlUEdHdzvmk4ebBs/edit?usp=sharing"><img alt="簡単献立シート" src="http://shirayuca.github.io/blog/2014/07/27/recipe/menusheet.png"></a></p>
<p><br /></p>

ということで、Googleスプレッドシートにクックパッドのレシピを表示できるようなファイルを作成しました。使い方はとても簡単で、

1. クックパッドで毎日のレシピを検索する
2. 検索したレシピのURLをスプレッドシート上のグレーのセルに貼り付ける

これだけです。

Googleスプレッドシートは共有も簡単なので、例えば家族とファイルを共有して1週間の献立を一緒に考えたり、あるいは、食材のまとめ買いにも使えそうです。また、シートをコピーして使用していけば、毎週の献立を保存しておくこともできるので、あの日のメニューもすぐに思い出せます。よかったら、ぜひ使ってみてください。  

<p><br /></p>
#### [かんたん献立シート](https://docs.google.com/spreadsheets/d/1YpToeif_6z-Nb3HXlo5VtG2eMUztlUEdHdzvmk4ebBs/edit?usp=sharing)
最初に使用する際は、[ファイル]→[コピーを作成]で、自分のGoogle Drive にコピーしてください。  
<p><br /></p>


<p><br /></p>
#### Googleスプレッドシート上で使用した関数
<p><br /></p>

Googleスプレッドシート上のB列を例に、以下に説明します。

- B2セル
 - クックパッドのレシピURLを入力

- B3セル
 - レシピの画像URLを取得（シート上では非表示）
```=importxml(B2,"//img[@class='analytics_tracking photo large_photo_clickable']/@src")
```

- B4セル
 - レシピのタイトルを取得
```=importxml(B2,"//h1")
```

- B5セル
 - B3セルで取得した画像URLを表示
```=image(B3,4,150,150)
```

- B6セル
 - レシピの材料を取得、行列入れ替えで表示
```=TRANSPOSE(importxml(B2,"//*[@id='ingredients_list']"))
```
<p><br /></p>