<!doctype html> 
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>shirayuca.github.io | かんたん献立シート</title>
    <meta content="" name="description" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" /><!--[if lt IE 9]><script src="../../../../js/ie8.js" type="text/javascript"></script><![endif]--><link href="../../../../css/all.css" media="screen" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle" data-target=".navbar-ex1-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">shirayuca.github.io</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="list-unstyled list-inline nav navbar-nav navbar-right">
            <li>
              <a href="https://github.com/shirayuca"><i class="fa fa-github-square fa-lg fa-inverse"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row"><div class="col-lg-3 col-md-3">
  <div class="well">
    <h4>
      Tags
    </h4>
    <ul class="list-unstyled">
      <li>
        <a href="/blog/tags/ブログ.html">ブログ</a> (2)
      </li>
      <li>
        <a href="/blog/tags/テーマ.html">テーマ</a> (1)
      </li>
      <li>
        <a href="/blog/tags/googleappsscript.html">GoogleAppsScript</a> (3)
      </li>
      <li>
        <a href="/blog/tags/学会.html">学会</a> (1)
      </li>
      <li>
        <a href="/blog/tags/ネットワーク分析.html">ネットワーク分析</a> (2)
      </li>
      <li>
        <a href="/blog/tags/mac.html">mac</a> (1)
      </li>
      <li>
        <a href="/blog/tags/参考文献.html">参考文献</a> (1)
      </li>
    </ul>
  </div>
</div>
<div class="col-lg-9 col-md-9">
  <h1>
    かんたん献立シート
  </h1>
  <hr />
  <p>
    <span class="glyphicon glyphicon-time"></span> Posted on Jul 27
  </p>
  <hr /><p><br /></p>

<p>最近、Googleスプレッドシートの importXML関数にハマっています。いろいろと遊んでいる中で、さらに image関数では画像表示もできることを知りました。それならば、ぜひ画像を表示したい…とあれこれ考えてみて、そうだ、クックパッドのレシピ画像を表示できたらいいな、ということになりました。  </p>

<p><br /></p>  

<p><a href="https://docs.google.com/spreadsheets/d/1YpToeif_6z-Nb3HXlo5VtG2eMUztlUEdHdzvmk4ebBs/edit?usp=sharing"><img alt="簡単献立シート" src="http://shirayuca.github.io/blog/2014/07/27/recipe/menusheet.png"></a></p>

<p><br /></p>

<p>ということで、Googleスプレッドシートにクックパッドのレシピを表示できるようなファイルを作成しました。使い方はとても簡単で、</p>

<ol>
<li>クックパッドで毎日のレシピを検索する</li>
<li>検索したレシピのURLをスプレッドシート上のグレーのセルに貼り付ける</li>
</ol>

<p>これだけです。</p>

<p>Googleスプレッドシートは共有も簡単なので、例えば家族とファイルを共有して1週間の献立を一緒に考えたり、あるいは、食材のまとめ買いにも使えそうです。また、シートをコピーして使用していけば、毎週の献立を保存しておくこともできるので、あの日のメニューもすぐに思い出せます。よかったら、ぜひ使ってみてください。  </p>

<p><br /></p>

<p>最初に使用する際は、[ファイル]→[コピーを作成]で、自分のGoogle Drive にコピーしてください。  </p>

<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1YpToeif_6z-Nb3HXlo5VtG2eMUztlUEdHdzvmk4ebBs/edit?usp=sharing">かんたん献立シート</a>
<p><br /></p></li>
</ul>

<p><br /></p>

<h4 id="googleスプレッドシート上で使用した関数">Googleスプレッドシート上で使用した関数</h4>

<p>Googleスプレッドシート上のB列を例に、以下に説明します。</p>

<ul>
<li><p>B2セル</p>

<ul>
<li>クックパッドのレシピURLを入力</li>
</ul></li>
<li><p>B3セル</p>

<ul>
<li>レシピの画像URLを取得（シート上では非表示）
<code>=importxml(B2,&quot;//img[@class=&#39;analytics_tracking photo large_photo_clickable&#39;]/@src&quot;)
</code></li>
</ul></li>
</ul>

<ul>
<li><p>B4セル</p>

<ul>
<li>レシピのタイトルを取得
<code>=importxml(B2,&quot;//h1&quot;)
</code></li>
</ul></li>
<li><p>B5セル</p>

<ul>
<li>B3セルで取得した画像URLを表示
<code>=image(B3,4,150,150)
</code></li>
</ul></li>
<li><p>B6セル</p>

<ul>
<li>レシピの材料を取得、行列入れ替えで表示
<code>=TRANSPOSE(importxml(B2,&quot;//*[@id=&#39;ingredients_list&#39;]&quot;))
</code>
<p><br /></p></li>
</ul></li>
</ul>

<p><br />
<br /></p>

  <hr>
    <p class="text-center">
      2014 <a href="/">shirayuca.github.io</a>
    </p>
  </hr>
</div>
      </div>
    </div>
    <script src="../../../../js/all.js" type="text/javascript"></script>
  </body>
</html>