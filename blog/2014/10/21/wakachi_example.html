<!doctype html> 
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>shirayuca.github.io | Googleスプレッドシートで分かち書きされた要素を数え上げ</title>
    <meta content="" name="description" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" /><!--[if lt IE 9]><script src="../../../../js/ie8.js" type="text/javascript"></script><![endif]--><link href="../../../../css/all.css" media="screen" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle" data-target=".navbar-ex1-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">shirayuca.github.io</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="list-unstyled list-inline nav navbar-nav navbar-right">
            <li>
              <a href="/works/">業績</a>
            </li>
            <li>
              <a href="/classes.html">講義</a>
            </li>
            <li>
              <a href="mailto:SHIRATSUCHI_Yuka@hj.sanno.ac.jp"><i class="fa fa-envelope fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="http://shirayuca.github.io/blog/"><i class="fa fa-pencil-square fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="https://twitter.com/shirayuca"><i class="fa fa-twitter-square fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="https://www.facebook.com/yuca.shiratsuchi"><i class="fa fa-facebook-square fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="https://github.com/shirayuca"><i class="fa fa-github-square fa-lg fa-inverse"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row"><div class="col-lg-3 col-md-3">
  <div class="well">
    <h4>
      Tags
    </h4>
    <ul class="list-unstyled">
      <li>
        <a href="/blog/tags/ブログ.html">ブログ</a> (2)
      </li>
      <li>
        <a href="/blog/tags/テーマ.html">テーマ</a> (1)
      </li>
      <li>
        <a href="/blog/tags/googleappsscript.html">GoogleAppsScript</a> (12)
      </li>
      <li>
        <a href="/blog/tags/学会.html">学会</a> (1)
      </li>
      <li>
        <a href="/blog/tags/ネットワーク分析.html">ネットワーク分析</a> (5)
      </li>
      <li>
        <a href="/blog/tags/mac.html">mac</a> (1)
      </li>
      <li>
        <a href="/blog/tags/データ.html">データ</a> (2)
      </li>
      <li>
        <a href="/blog/tags/参考文献.html">参考文献</a> (4)
      </li>
      <li>
        <a href="/blog/tags/文化.html">文化</a> (6)
      </li>
      <li>
        <a href="/blog/tags/拡張.html">拡張</a> (1)
      </li>
      <li>
        <a href="/blog/tags/ソーシャルメディア.html">ソーシャルメディア</a> (2)
      </li>
      <li>
        <a href="/blog/tags/統計.html">統計</a> (1)
      </li>
      <li>
        <a href="/blog/tags/分析.html">分析</a> (1)
      </li>
      <li>
        <a href="/blog/tags/生活.html">生活</a> (1)
      </li>
      <li>
        <a href="/blog/tags/授業.html">授業</a> (1)
      </li>
    </ul>
  </div>
</div>
<div class="col-lg-9 col-md-9">
  <h1>
    Googleスプレッドシートで分かち書きされた要素を数え上げ
  </h1>
  <hr />
  <p>
    <span class="glyphicon glyphicon-time"></span> Posted on Oct 21
  </p>
  <hr /><p><br /></p>

<p>Googleスプレッドシートで、分かち書きされた要素を数え上げます。</p>

<p><br /></p>

<h4 id="スクリプト">スクリプト</h4>

<p>下記の2つの記事で紹介しているスクリプトを、Googleスプレッドシートの [ツール]→[スクリプトエディタ]から貼りつけ、保存してください。</p>

<ul>
<li><a href="http://shirayuca.github.io/blog/2014/10/19/wordcount.html">http://shirayuca.github.io/blog/2014/10/19/wordcount.html</a></li>
<li><a href="http://shirayuca.github.io/blog/2014/10/21/wakachigaki.html">http://shirayuca.github.io/blog/2014/10/21/wakachigaki.html</a></li>
</ul>

<p>下記のように、各々のスクリプトファイル（〜.gs）を作成します。</p>

<p><img src="https://qiita-image-store.s3.amazonaws.com/0/48375/27952c95-fb78-bff5-5e87-a26384568ee8.png" width=400px /></p>

<p><br /></p>

<h4 id="使い方">使い方</h4>

<p>下記の公開スプレッドシートにて、実際の使い方の例を示しています。</p>

<ul>
<li><a href="https://docs.google.com/spreadsheets/d/17SPL31fsaraUZhsxnBTxRZaGiXbYdISFWA_7UV3mKMg/edit?usp=sharing">https://docs.google.com/spreadsheets/d/17SPL31fsaraUZhsxnBTxRZaGiXbYdISFWA_7UV3mKMg/edit?usp=sharing</a></li>
</ul>

<p><br /></p>

<h5 id="手順1：分かち書き">手順1：分かち書き</h5>

<p>まず、任意のテキスト群を用意します。今回は、素敵な鬼女様（ <a href="http://sutekinakijo.com/">http://sutekinakijo.com/</a> ）の新着タイトルを<code>=IMPORTXML()</code>関数で取得しました。A2セルにはブログURLが入っています。</p>

<pre><code>=importxml(A2,&quot;//h1[@class=&#39;article-title&#39;]&quot;)
</code></pre>

<p>その後、テキストの隣のセルに、<code>=wakachigaki()</code>関数と<code>=TRANSPOSE()</code>関数を組み合わせ、分かち書きされた要素を横列に表示します。B2セルにはブログタイトルテキストが入っています。</p>

<pre><code>=transpose(wakachigaki(B2))
</code></pre>

<p><img src="https://qiita-image-store.s3.amazonaws.com/0/48375/c097dace-a8c5-9243-7991-23a2558e8bbf.png" width=800px /></p>

<p><br /></p>

<h5 id="手順2：数え上げ">手順2：数え上げ</h5>

<p>新しいシート上で、<code>=wordCount()</code>関数を実行し、先ほど横列に順次表示された分かち書き後要素を数え上げます。<code>=wordCount()</code>関数では、分かち書きされた要素がある範囲全てを参照してください。</p>

<p><img src="https://qiita-image-store.s3.amazonaws.com/0/48375/4e7910a5-bf4d-8d99-6ec7-92a8f3ad8a1a.png" width=300px /></p>

<p>数え上げ結果は、新しいシートで値として貼付けしソートする等、適宜活用してください。</p>

<p><img alt="5.png" src="https://qiita-image-store.s3.amazonaws.com/0/48375/b6679f12-5588-713c-89e1-2410b1106b98.png" /></p>

<p><br /></p>

<h4 id="参考">参考</h4>

<ul>
<li><a href="http://chasen.org/%7Etaku/software/TinySegmenter/">http://chasen.org/~taku/software/TinySegmenter/</a></li>
</ul>

<p><br /></p>

  <hr>
    <p class="text-center">
      2014 <a href="/">shirayuca.github.io</a>
    </p>
  </hr>
</div>
      </div>
    </div>
    <script src="../../../../js/all.js" type="text/javascript"></script>
  </body>
</html>