<!doctype html> 
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>shirayuca.github.io | GoogleスプレッドシートでTwitter検索結果のデータ収集</title>
    <meta content="" name="description" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" /><!--[if lt IE 9]><script src="../../../../js/ie8.js" type="text/javascript"></script><![endif]--><link href="../../../../css/all.css" media="screen" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle" data-target=".navbar-ex1-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">shirayuca.github.io</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="list-unstyled list-inline nav navbar-nav navbar-right">
            <li>
              <a href="/works/">業績</a>
            </li>
            <li>
              <a href="/classes.html">講義</a>
            </li>
            <li>
              <a href="mailto:SHIRATSUCHI_Yuka@hj.sanno.ac.jp"><i class="fa fa-envelope fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="http://shirayuca.github.io/blog/"><i class="fa fa-pencil-square fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="https://twitter.com/shirayuca"><i class="fa fa-twitter-square fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="https://www.facebook.com/yuca.shiratsuchi"><i class="fa fa-facebook-square fa-lg fa-inverse"></i></a>
            </li>
            <li>
              <a href="https://github.com/shirayuca"><i class="fa fa-github-square fa-lg fa-inverse"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row"><div class="col-lg-3 col-md-3">
  <div class="well">
    <h4>
      Tags
    </h4>
    <ul class="list-unstyled">
      <li>
        <a href="/blog/tags/ブログ.html">ブログ</a> (2)
      </li>
      <li>
        <a href="/blog/tags/テーマ.html">テーマ</a> (1)
      </li>
      <li>
        <a href="/blog/tags/googleappsscript.html">GoogleAppsScript</a> (11)
      </li>
      <li>
        <a href="/blog/tags/学会.html">学会</a> (1)
      </li>
      <li>
        <a href="/blog/tags/ネットワーク分析.html">ネットワーク分析</a> (5)
      </li>
      <li>
        <a href="/blog/tags/mac.html">mac</a> (1)
      </li>
      <li>
        <a href="/blog/tags/データ.html">データ</a> (2)
      </li>
      <li>
        <a href="/blog/tags/参考文献.html">参考文献</a> (4)
      </li>
      <li>
        <a href="/blog/tags/文化.html">文化</a> (6)
      </li>
      <li>
        <a href="/blog/tags/拡張.html">拡張</a> (1)
      </li>
      <li>
        <a href="/blog/tags/ソーシャルメディア.html">ソーシャルメディア</a> (2)
      </li>
      <li>
        <a href="/blog/tags/統計.html">統計</a> (1)
      </li>
      <li>
        <a href="/blog/tags/分析.html">分析</a> (1)
      </li>
    </ul>
  </div>
</div>
<div class="col-lg-9 col-md-9">
  <h1>
    GoogleスプレッドシートでTwitter検索結果のデータ収集
  </h1>
  <hr />
  <p>
    <span class="glyphicon glyphicon-time"></span> Posted on Sep  7
  </p>
  <hr /><p><br /></p>

<p>Googleスプレッドシートを使って、任意のキーワードでTwitter検索をした結果のデータを収集します。最初の設定に少しだけ手間がかかりますが、1度設定すれば、あとは勝手にデータを収集し続けてくれるので、お手軽で便利です。作成は基本的に、下記のブログで紹介されているスクリプトをベースとしており、そこから特定セルに検索キーワードを入れるなどの加工を行っています。大変お世話になりました、ありがとうございます。</p>

<ul>
<li><a href="http://blog.hika69.com/blog/2014/01/28/google-apps-script/">http://blog.hika69.com/blog/2014/01/28/google-apps-script/</a></li>
</ul>

<p><img src="http://shirayuca.github.io/blog/2014/09/07/twitter-data/twitter1.png"></p>

<p><br /></p>

<h4 id="手順">手順</h4>

<ol>
<li>Twitterアプリの作成</li>
<li>GoogleスプレッドシートとTwitterアプリの連携</li>
<li>Googleスプレッドシートでスクリプトの編集</li>
</ol>

<p><br /></p>

<h4 id="1.-twitterアプリの作成">1. Twitterアプリの作成</h4>

<p><a href="https://dev.twitter.com/">Twitter Developers</a>の<a href="https://apps.twitter.com">Twitter Application Management</a>にてアプリケーションを作成し、データ収集に必要なAPIキー等を取得します。私は下記のように入力しました。</p>

<ul>
<li>Name: for GoogleAppsScript(任意の名前)</li>
<li>Description: GoogleAppsScriptから利用します(任意の説明)</li>
<li>Website: <a href="http://shirayuca.github.io/">http://shirayuca.github.io/</a> (任意のURL)</li>
<li>Callback URL: <a href="https://spreadsheets.google.com/macros">https://spreadsheets.google.com/macros</a> (左記と同じように入力)</li>
</ul>

<p>作成すると、<code>API key</code>と<code>API secret</code>が発行されます。</p>

<p><br /></p>

<h4 id="2.-googleスプレッドシートとtwitterアプリの連携">2. GoogleスプレッドシートとTwitterアプリの連携</h4>

<p>任意の名前でGoogleスプレッドシートを作成します。その後、メニューバーから<code>ツール &gt; スクリプトエディタ</code>を選択します。ここでも任意のプロジェクト名をつけてください。</p>

<p>続いて、スクリプトエディタのメニューバーから<code>リソース &gt; ライブラリ</code>を選択し、「ライブラリを検索」に<code>MHGYgT-unu1fC7zXOkNfBUVSHJARy_IP7</code>と入力します。その後、選択ボタンを押して、Twitterのライブラリが表示されたら、バージョンを「1」として保存します。</p>

<p><img src="http://shirayuca.github.io/blog/2014/09/07/twitter-data/twitter2.png"></p>

<p>その後、スクリプトエディタのメニューバーから<code>ファイル &gt; プロジェクトのプロパティ</code>を選択し、ユーザープロパティのタブで、Twitterアプリ作成時に発行された<code>API key</code>と<code>API secret</code>を下記のように入力します。入力し終えたら、保存します。</p>

<ul>
<li><code>TWITTER_CONSUMER_KEY</code> に <code>API key</code></li>
<li><code>TWITTER_CONSUMER_SECRET</code> に <code>API secret</code></li>
</ul>

<p><br /></p>

<h4 id="3.-googleスプレッドシートでスクリプトの編集">3. Googleスプレッドシートでスクリプトの編集</h4>

<p>コード.gs上に、下記のGistスクリプトをコピーし、保存してください。</p>

<ul>
<li><a href="https://gist.github.com/shirayuca/88c309c168052d35d29d">https://gist.github.com/shirayuca/88c309c168052d35d29d</a></li>
</ul>

<p>スプレッドシートに戻り、A1に検索キーワードを入力してください。データは、4行目以降(A4セル以降)に出力されます。そのため、下表のように、3行目のA3セルからF3列に、適宜列名を付与するといいでしょう。</p>

<table><thead>
<tr>
<th>セル</th>
<th>列名</th>
</tr>
</thead><tbody>
<tr>
<td>A3</td>
<td>ID</td>
</tr>
<tr>
<td>B3</td>
<td>日時</td>
</tr>
<tr>
<td>C3</td>
<td>tweet</td>
</tr>
<tr>
<td>D3</td>
<td>tweetURL</td>
</tr>
<tr>
<td>E3</td>
<td>USER</td>
</tr>
<tr>
<td>F3</td>
<td>tweet内URL</td>
</tr>
</tbody></table>

<p><img src="http://shirayuca.github.io/blog/2014/09/07/twitter-data/twitter3.png"></p>

<p>その後、スクリプトエディタに戻り、メニューバーから<code>実行 &gt; myFunction</code>で、スクリプトを実行します。初回実行時のみ、色々な承認のアラートが出るので、OKとしてください。</p>

<p>定期的に検索し、データを蓄積していきたい場合は、スクリプトエディタのメニューバーから<code>リソース &gt; すべてのトリガー</code>に移動し、「新しいトリガーを追加」して、myFunctionを定期的に実行するタイマーを指定します。下記の画像の例では、30分ごとに検索を行っています。トリガーの初回起動時にも承認アラーとが出るので、OKとしてください。</p>

<p><img src="http://shirayuca.github.io/blog/2014/09/07/twitter-data/twitter4.png"></p>

<p><br /></p>

  <hr>
    <p class="text-center">
      2014 <a href="/">shirayuca.github.io</a>
    </p>
  </hr>
</div>
      </div>
    </div>
    <script src="../../../../js/all.js" type="text/javascript"></script>
  </body>
</html>